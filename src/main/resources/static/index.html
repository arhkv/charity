<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Charity Donation Platform</title>
    <style>
        body{font-family:Arial;background:#111;color:#eee;padding:20px}
        h1{margin-bottom:10px}
        .box{background:#1c1f26;padding:15px;border-radius:8px;margin-bottom:20px}
        input,select,button{padding:8px;margin:5px 0;width:100%}
        button{background:#6c5ce7;color:#fff;border:none;border-radius:6px;cursor:pointer}
        button.del{background:#ff4d4f}
        table{width:100%;border-collapse:collapse;margin-top:10px}
        th,td{border-bottom:1px solid #333;padding:6px}
        .scroll{max-height:220px;overflow:auto}
        .actions button{width:auto;margin-right:5px}
    </style>
</head>
<body>

<h1>Charity Donation Platform</h1>
<button onclick="refreshAll()">üîÑ Refresh All</button>

<!-- DONORS -->
<div class="box">
    <h2>Donors</h2>
    <input id="dn" placeholder="Name">
    <input id="de" placeholder="Email">
    <button onclick="addDonor()">Add donor</button>

    <div class="scroll">
        <table>
            <thead><tr><th>ID</th><th>Name</th><th>Email</th><th>Actions</th></tr></thead>
            <tbody id="donors"></tbody>
        </table>
    </div>
</div>

<!-- CHARITIES -->
<div class="box">
    <h2>Charities</h2>
    <input id="cn" placeholder="Name">
    <input id="cd" placeholder="Description">
    <button onclick="addCharity()">Add charity</button>

    <div class="scroll">
        <table>
            <thead><tr><th>ID</th><th>Name</th><th>Description</th><th>Actions</th></tr></thead>
            <tbody id="charities"></tbody>
        </table>
    </div>
</div>

<!-- DONATIONS -->
<div class="box">
    <h2>Donations</h2>
    <select id="dd"></select>
    <select id="dc"></select>
    <input id="da" type="number" placeholder="Amount">
    <input id="dcom" placeholder="Comment">
    <button onclick="addDonation()">Add donation</button>

    <div class="scroll">
        <table>
            <thead><tr><th>ID</th><th>Donor</th><th>Charity</th><th>Amount</th><th>Actions</th></tr></thead>
            <tbody id="donations"></tbody>
        </table>
    </div>
</div>

<script>
    const API="/api";

    const req = (url,method="GET",body)=>
        fetch(API+url,{
            method,
            headers:{"Content-Type":"application/json"},
            body:body?JSON.stringify(body):null
        }).then(r=>r.ok?r.json():Promise.reject());

    /* -------- DONORS -------- */
    async function loadDonors(){
        const d=await req("/donors");
        donors.innerHTML=d.map(x=>`
<tr>
<td>${x.id}</td><td>${x.name}</td><td>${x.email}</td>
<td class="actions">
<button onclick="editDonor(${x.id},'${x.name}','${x.email}')">‚úèÔ∏è</button>
<button class="del" onclick="delDonor(${x.id})">üóë</button>
</td></tr>`).join("");
        dd.innerHTML=d.map(x=>`<option value="${x.id}">${x.name}</option>`).join("");
    }

    function addDonor(){
        req("/donors","POST",{name:dn.value,email:de.value}).then(loadDonors);
        dn.value=de.value="";
    }
    function editDonor(id,n,e){
        const name=prompt("New name:",n);
        const email=prompt("New email:",e);
        if(name&&email) req(`/donors/${id}`,"PUT",{name,email}).then(loadDonors);
    }
    function delDonor(id){
        if(confirm("Delete donor?")) req(`/donors/${id}`,"DELETE").then(loadDonors);
    }

    /* -------- CHARITIES -------- */
    async function loadCharities(){
        const c=await req("/charities");
        charities.innerHTML=c.map(x=>`
<tr>
<td>${x.id}</td><td>${x.name}</td><td>${x.description}</td>
<td class="actions">
<button onclick="editCharity(${x.id},'${x.name}','${x.description}')">‚úèÔ∏è</button>
<button class="del" onclick="delCharity(${x.id})">üóë</button>
</td></tr>`).join("");
        dc.innerHTML=c.map(x=>`<option value="${x.id}">${x.name}</option>`).join("");
    }
    function addCharity(){
        req("/charities","POST",{name:cn.value,description:cd.value}).then(loadCharities);
        cn.value=cd.value="";
    }
    function editCharity(id,n,d){
        const name=prompt("New name:",n);
        const desc=prompt("New description:",d);
        if(name&&desc) req(`/charities/${id}`,"PUT",{name,description:desc}).then(loadCharities);
    }
    function delCharity(id){
        if(confirm("Delete charity?")) req(`/charities/${id}`,"DELETE").then(loadCharities);
    }

    /* -------- DONATIONS -------- */
    async function loadDonations(){
        const d=await req("/donations");
        donations.innerHTML=d.map(x=>`
<tr>
<td>${x.id}</td><td>${x.donorId}</td><td>${x.charityId}</td><td>${x.amount}</td>
<td class="actions">
<button onclick="editDonation(${x.id},${x.amount})">‚úèÔ∏è</button>
<button class="del" onclick="delDonation(${x.id})">üóë</button>
</td></tr>`).join("");
    }
    function addDonation(){
        req("/donations","POST",{donorId:dd.value,charityId:dc.value,amount:da.value,comment:dcom.value})
            .then(loadDonations);
        da.value=dcom.value="";
    }
    function editDonation(id,a){
        const amount=prompt("New amount:",a);
        if(amount>0) req(`/donations/${id}`,"PUT",{amount}).then(loadDonations);
    }
    function delDonation(id){
        if(confirm("Delete donation?")) req(`/donations/${id}`,"DELETE").then(loadDonations);
    }

    /* -------- INIT -------- */
    function refreshAll(){loadDonors();loadCharities();loadDonations();}
    refreshAll();
</script>

</body>
</html>
